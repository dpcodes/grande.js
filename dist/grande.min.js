(function(a,b){var c=-999,d=d||function(d,e){function f(a,b){for(var c in b)a[c]=b[c];return a}function g(){if(_.placeholder){var a;for(i=0,len=Y.length;len>i;i++)a=Y[i],a[y(a)]||(h(a,_.placeholder),a.onblur=O,a.onfocus=N)}}function h(a,b){p=X.createElement("span"),p.innerText=b,p.className="g-placeholder",a.appendChild(p)}function j(){var a=X.createElement("div"),b="<div class='options'>             <span class='no-overflow'>               <span class='ui-inputs'>                 <button class='bold'>B</button>                 <button class='italic'>i</button>                 <button class='header1'>h1</button>                 <button class='header2'>h2</button>                 <button class='quote'>&rdquo;</button>                 <button class='url useicons'>&#xe001;</button>                 <input class='url-input' type='text' placeholder='Paste or type a link'/>               </span>             </span>           </div>",c=X.createElement("div"),d=X.createElement("div");d.className="g-body",X.body.appendChild(d),c.innerHTML="<div class='pos-abs file-label'>Insert image</div>                                           <input class='file-hidden pos-abs' type='file' id='files' name='files[]' accept='image/*' multiple/>",c.className="image-tooltip hide",a.className="text-menu hide",a.innerHTML=b,0===X.querySelectorAll(".text-menu").length&&(d.appendChild(a),d.appendChild(c)),U=X.querySelectorAll(".file-label + input")[0],T=X.querySelectorAll(".image-tooltip")[0],P=X.querySelectorAll(".text-menu")[0],Q=X.querySelectorAll(".text-menu .options")[0],R=X.querySelectorAll(".text-menu .url-input")[0]}function k(){var a,b,c;for(W.onresize=L,R.onblur=D,R.onkeydown=E,_.allowImages&&(T.onmousedown=m,U.onchange=n,X.onmousemove=l),a=0,b=Y.length;b>a;a++)c=Y[a],c.contentEditable=!0,c.className=c.className+" g-editor",c.onmousedown=L,c.onmouseup=function(a){setTimeout(function(){L(a)},1)},c.onkeydown=v,c.onkeyup=function(a){var b=window.getSelection();b.anchorNode&&"ARTICLE"!==b.anchorNode.nodeName&&(w(a),b.isCollapsed&&A(a))},c.onmousedown=c.onkeyup=c.onmouseup=L}function l(a){o(a,a.target)}function m(){var a=Z.children,b=Z.getBoundingClientRect();V=q(a,b)}function n(){var a,b=this.files[0],c=new FileReader;c.onload=function(){return function(b){a=X.createElement("figure"),a.innerHTML='<img src="'+b.target.result+'"/>',Z.insertBefore(a,V.bottomElement)}}(b),c.readAsDataURL(b)}function o(){var a=Z.children,b=Z.getBoundingClientRect(),d=q(a,b);d?(T.style.left=b.left-90+"px",T.style.top=d.top-17+"px"):(T.style.left=c+"px",T.style.top=c+"px")}function q(a){var b,c,d,e,f,g,h,i,j=[];for(c=0,d=a.length-1;d>c;c++)e=a[c],f=a[c+1]||null,g=e.getBoundingClientRect().bottom-5,h=f.getBoundingClientRect().top,j.push({top:h,bottom:g,topElement:e,bottomElement:f,index:c+1});for(i=event.pageY-W.scrollY,c=0,d=j.length;d>c;c++)if(b=j[c],i<b.top&&i>b.bottom)return b;return null}function r(a){var b,c,d,e=X.querySelectorAll(".text-menu button"),f=function(b){a(b)};for(b=0,c=e.length;c>b;b++)d=e[b],f(d)}function s(){r(function(a){a.onmousedown=function(){C(a)}})}function t(){return W.getSelection().focusNode}function u(){var a,b,c,d=t();r(function(e){a=e.className;for(var f in bb)if(b=bb[f],c=new RegExp(b),c.test(a)){e.className=J(d,f)?b+" active":b;break}})}function v(a){var b,c=window.getSelection(),d=I(c.anchorNode,"p");return"inline"===_.mode&&13===a.keyCode?void a.preventDefault():void(13===a.keyCode&&d&&(prevSibling=d.previousSibling,b=prevSibling&&"HR"===prevSibling.nodeName&&!d.textContent.length,b&&a.preventDefault()))}function w(a){var b,c=window.getSelection();13===a.keyCode&&("DIV"===c.anchorNode.nodeName&&F("p"),b=I(c.anchorNode,"p"),b&&x(b))}function x(a){var b,c,d;for(b=a.previousSibling,c=b;c&&c.nodeType==Node.TEXT_NODE;)c=c.previousSibling;"P"!==b.nodeName||b.textContent.length||"HR"===c.nodeName||(d=X.createElement("hr"),d.contentEditable=!1,a.parentNode.replaceChild(d,b))}function y(a){var b;return b=a.nodeType===Node.TEXT_NODE?"data":$?"textContent":"innerText"}function z(a,b,c){var d="ol"===c?"insertOrderedList":"insertUnorderedList",e="ol"===c?3:2;return X.execCommand(d),a.anchorNode[b]=a.anchorNode[b].substring(e),I(a.anchorNode,c)}function A(){var a,b,c,d,e,f,g=window.getSelection();g.isCollapsed&&g.anchorNode&&"ARTICLE"!==g.anchorNode.nodeName&&(a=y(g.anchorNode),b=g.anchorNode[a],b.match(/^[-*]\s/)&&"LI"!==g.anchorNode.parentNode.nodeName&&(c=z(g,a,"ul")),b.match(/^1\.\s/)&&"LI"!==g.anchorNode.parentNode.nodeName&&(c=z(g,a,"ol")),d=c&&["ul","ol"].indexOf(c.nodeName.toLocaleLowerCase())>=0&&["p","div"].indexOf(c.parentNode.nodeName.toLocaleLowerCase())>=0,d&&(e=g.anchorNode,f=c.parentNode,f.parentNode.insertBefore(c,f),f.parentNode.removeChild(f),B(g,e)))}function B(a,b){range=X.createRange(),range.setStart(b,0),range.setEnd(b,0),a.removeAllRanges(),a.addRange(range)}function C(a){var b,c,d=a.className,e=window.getSelection(),f=e.anchorNode;for(var g in bb)if(b=bb[g],c=new RegExp(b),c.test(d))switch(g){case"b":return void(!f||J(f,"h1")||J(f,"h2")||X.execCommand(b,!1));case"i":return void X.execCommand(b,!1);case"h1":case"h2":case"h3":case"blockquote":return void F(g);case"a":return G(),void(Q.className="options url-mode")}L()}function D(){var a=R.value;return Q.className="options",window.getSelection().addRange(S),X.execCommand("unlink",!1),""===a?!1:(a.match("^(http://|https://|mailto:)")||(a="http://"+a),X.execCommand("createLink",!1,a),void(R.value=""))}function E(a){13===a.keyCode&&(a.preventDefault(),a.stopPropagation(),R.blur())}function F(a){J(t(),a)?(X.execCommand("formatBlock",!1,"p"),X.execCommand("outdent")):X.execCommand("formatBlock",!1,a)}function G(){setTimeout(function(){var a=K(t());"undefined"!=typeof a?R.value=a:X.execCommand("createLink",!1,"/"),S=window.getSelection().getRangeAt(0),R.focus()},150)}function H(a,b,c){if(null!==a)for(;a.parentNode;){if(b(a))return c(a);a=a.parentNode}}function I(a,b){var c=function(a){return a.nodeName.toLowerCase()===b},d=function(a){return a};return H(a,c,d)}function J(a,b){return!!I(a,b)}function K(a){var b=function(a){return"undefined"!=typeof a.href},c=function(a){return a.href};return H(a,b,c)}function L(a){var b,d,e=W.getSelection(),f=a.target||a.srcElement;return f.isContentEditable&&"rich"===_.mode?void(e.isCollapsed?(M(c,c),P.className="text-menu hide"):(b=e.getRangeAt(0),d=b.getBoundingClientRect(),u(),M(d.top-5+W.pageYOffset,(d.left+d.right)/2))):void u()}function M(a,b){P.style.top=a+"px",P.style.left=b+"px",_.animate&&(P.className=a===c?"text-menu hide":"text-menu active")}function N(a){for(var b,c=a.target,d=c.getElementsByClassName("g-placeholder"),e=0;e<d.length;e++)c.removeChild(d[e]),b=!0;if(b){var f=X.createRange();f.selectNodeContents(this);var g=window.getSelection();g.removeAllRanges(),g.addRange(f)}}function O(a){var b=a.target,d=b[y(b)];d.trim()||h(b,_.placeholder),M(c,c),P.className="text-menu hide"}var P,Q,R,S,T,U,V,W=a,X=b,Y=X.querySelectorAll(".g-body article"),Z=Y[0],$=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,_={animate:!0,placeholder:null,mode:"rich"},ab=function(a,b){a&&(Y=a),_=f(_,b),j(),g(),k(),s()},bb={b:"bold",i:"italic",h1:"header1",h2:"header2",a:"url",blockquote:"quote"};ab(d,e)};"undefined"!=typeof module&&module.exports&&(module.exports=d),"undefined"==typeof ender&&(this.Grande=d),"function"==typeof define&&define.amd&&define("Grande",[],function(){return d})}).call(this,window,document);